<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="header-placeholder"></div>

    <main>
        <h1 style="padding-left: 200px; padding-right: 200px;">TOP GAMES</h1>
        <div class="row">
            <!-- Top games will be rendered here by JS -->
        </div>
        <h1 style="padding-left: 200px; padding-right: 200px;">ALL GAMES</h1>
        <div class="long-box-links" id="all-games"></div>

    </main>

    <footer>
        <p>&copy; 2025 SUPERGEM. All rights reserved.</p>
    </footer>
    <script>
// Load header.html into #header-placeholder
fetch('header.html')
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.text();
    })
    .then(html => {
        document.getElementById('header-placeholder').innerHTML = html;
        // Re-attach menu toggle JS if needed
        const menuToggle = document.querySelector('.menu-toggle');
        if (menuToggle) {
            menuToggle.addEventListener('click', function() {
                document.querySelector('.navbar').classList.toggle('open');
            });
        }
    })
    .catch(error => {
        console.error('Error loading header:', error);
        document.getElementById('header-placeholder').innerHTML = '<div style="color:red;">Header failed to load.</div>';
    });

const topGames = [
    {
        id: "top2",
        name: "Merge and Fire",
        img: "images/mergeandfire.png",
        downloads: "5k+ downloads",
        android: "https://play.google.com/store/apps/details?id=com.MangasGames.Mergeandfire",
        ios: "https://apps.apple.com/us/app/6459738321"
    },
    {
        id: "top3",
        name: "Paper Please",
        img: "images/PaperPlease.png",
        downloads: "1k+ downloads",
        android: "https://play.google.com/store/apps/details?id=com.SuperGem.PaperPlease",
        ios: "https://apps.apple.com/us/app/6670699846"
    },
    {
        id: "top4",
        name: "Stealth Master",
        img: "images/Stealthmaster.png",
        downloads: "100+ downloads",
        android: "https://play.google.com/store/apps/details?id=com.SUPERGEM.Stealthmaster",
        ios: null
    }
];

function isiPhone() {
    return /iPhone|iPod|Macintosh/i.test(navigator.userAgent);
}

function renderTopGames() {
    const row = document.querySelector('.row');
    row.innerHTML = '';
    topGames.forEach(game => {
        const isIOS = isiPhone();
        let storeLink = isIOS ? game.ios : game.android;
        // If the preferred link is missing/null, use the other one
        if (!storeLink) {
            storeLink = isIOS ? game.android : game.ios;
        }
        const a = document.createElement('a');
        a.id = game.id;
        a.href = storeLink;
        a.innerHTML = `
            <img src="${game.img}" alt="${game.name}">
            <h3>${game.name}</h3>
            <p>${game.downloads}</p>
        `;
        const div = document.createElement('div');
        div.className = 'column';
        div.appendChild(a);
        row.appendChild(div);
    });
}

// Fetch game data from SheetDB.io API
function fetchSheetDBData() {
    const url = 'https://sheetdb.io/api/v1/1rkz907ehzww4';
    fetch(url)
        .then(response => response.json())
        .then(games => {
            console.log('Fetched games data:', games);
             games.sort((a, b) => parseInt(b.id) - parseInt(a.id));
            const container = document.getElementById('all-games');
            container.innerHTML = '';
            if (!Array.isArray(games) || games.length === 0) {
                container.innerHTML = '<p style="color:red">No game data found. Check your SheetDB.io sheet and column names.</p>';
                return;
            }
            games.forEach(game => {
                // Detect system
                const isIOS = /iPhone|iPad|iPod|Macintosh/i.test(navigator.userAgent);
                let storeLink = isIOS ? game.ios : game.android;
                if (!storeLink) {
                    storeLink = isIOS ? game.android : game.ios;
                }
                container.innerHTML += `
                    <div class="long-box">
                        <a href="${storeLink}" target="_blank">
                            <img src="${game.img}" alt="App Icon">
                            <div>
                                <h3>${game.name}</h3>
                                <p>${game.genre}</p>
                                <div class="star-rating">
                                    <img src="images/star.png" alt="Star">
                                    <p>${game.rating !== null ? game.rating : ''}</p>
                                </div>
                            </div>
                        <script>
                    </div>
                `;
            });
        })
        .catch(error => {
            console.error('Error loading SheetDB.io:', error);
            const container = document.getElementById('all-games');
            container.innerHTML = `<p style='color:red'>Error loading SheetDB.io: ${error.message}</p>`;
        });
}

window.onload = function() {
    renderTopGames();
    fetchSheetDBData();
};
    </script>


</body>
</html>
